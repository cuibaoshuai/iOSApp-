import UIKit

class MainViewController: UITabBarController, UITabBarControllerDelegate {

    override func viewDidLoad() {
        super.viewDidLoad()
        delegate = self
        addChildViewController(childControllerName: "HomeViewController", title: "首页", imageName: "tabbar_one")
        addChildViewController(childControllerName: "ProjectListViewController", title: "二页", imageName: "tabbar_two")
        addChildViewController(childControllerName: "ShopViewController", title: "三页", imageName: "tabbar_three")
        addChildViewController(childControllerName: "FindViewController", title: "四页", imageName: "tabbar_four")
        addChildViewController(childControllerName: "MyViewController", title: "五页", imageName: "tabbar_five")
        
        
    }
    //遵循代理
    func tabBarController(_ tabBarController: UITabBarController, shouldSelect viewController: UIViewController) -> Bool {
        //对控制器进行拦截
        if viewController == tabBarController.viewControllers?[4] {
            return false
        }
        
        return true
    }
    
    func addChildViewController(childControllerName: String,title: String,imageName: String){
        
         let nameSpace = Bundle.main.infoDictionary!["CFBundleExecutable"]
         if let ns = nameSpace as? String
         {
         // 注意: 1.在Swift中, 如果想通过字符串创建一个类, 那么必须加上命名空间
         //       2.动态获取的命名空间是不包含.的, 所以需要我们自己手动拼接
         let cls: AnyClass? = NSClassFromString(ns + "." + childControllerName)
         // 1.将AnyClass类型转换为UIViewController类型
         // AnyClass本质: AnyObject.Type
         // UIViewController本质: UIViewController.Type
         if let clsType = cls as? UIViewController.Type
         {
         // 2.根据控制器类类型创建一个控制器对象
         let homeVC = clsType.init()
         print(homeVC)
         
         // 1.添加子控制器
         // 如果是在iOS8以前, 只有文字有效果, 而图片没有效果
         tabBar.tintColor = UIColor.orange
         
         // 1.2设置子控制器的相关属性
         homeVC.tabBarItem.image = UIImage(named: imageName)
         homeVC.tabBarItem.selectedImage = UIImage(named: imageName
         + "_highlighted")
         // 系统会由内向外的设置标题
         homeVC.title = title
         
         // 1.3给子控制器包装一个导航控制器
         //let nav = UINavigationController(rootViewController: homeVC)
            let nav = CBSNaviViewController(rootViewController:homeVC)
            nav.navigationBar.isTranslucent = false
         // 1.4添加
         addChildViewController(nav)
         }
         }
